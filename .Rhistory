#'   \item{increased relapse 2}{Relapse multiplier for category 2.}
#'   \item{increased relapse 3}{Relapse multiplier for category 3.}
#'   \item{increased relapse 4}{Relapse multiplier for category 4.}
#'   \item{increased relapse 5}{Relapse multiplier for category 5.}
#'
#'   \item{discount rate daly averted}{Annual discount rate applied to DALYs averted.}
#'   \item{discount rate costs}{Annual discount rate applied to costs.}
#'
#'   \item{dw conversion factor}{Disability weight conversion factor.}
#'   \item{Lower range dw conversion factor}{Lower bound of the disability weight conversion factor.}
#'   \item{Upper range dw conversion factor}{Upper bound of the disability weight conversion factor.}
#'
#'   \item{Scale/shape Gamma cost distribution}{Scale/shape parameter for a Gamma cost distribution.}
#'   \item{Incidence no history}{Incidence among individuals with no prior history.}
#'
#'   \item{pmild}{Proportion of incident cases that are mild.}
#'   \item{pmoderate}{Proportion of incident cases that are moderate.}
#'   \item{psevere}{Proportion of incident cases that are severe.}
#'
#'   \item{mildrecovery}{Probability of full recovery from mild disease.}
#'   \item{mildpartial}{Probability of partial recovery from mild disease.}
#'   \item{mildchronic}{Probability of chronic course after mild disease.}
#'
#'   \item{moderaterecovery}{Probability of full recovery from moderate disease.}
#'   \item{moderatepartial}{Probability of partial recovery from moderate disease.}
#'   \item{moderatechronic}{Probability of chronic course after moderate disease.}
#'
#'   \item{severerecovery}{Probability of full recovery from severe disease.}
#'   \item{severepartial}{Probability of partial recovery from severe disease.}
#'   \item{severechronic}{Probability of chronic course after severe disease.}
#'
#'   \item{mildrecoverycured}{Among mild recoveries, probability of being cured.}
#'   \item{mildrecoveryrelapse}{Among mild recoveries, probability of relapse.}
#'   \item{mildpartialcured}{Among mild partial recoveries, probability of being cured.}
#'   \item{mildpartialrelapse}{Among mild partial recoveries, probability of relapse.}
#'
#'   \item{moderaterecoverycured}{Among moderate recoveries, probability of being cured.}
#'   \item{moderaterecoveryrelapse}{Among moderate recoveries, probability of relapse.}
#'   \item{moderatepartialcured}{Among moderate partial recoveries, probability of being cured.}
#'   \item{moderatepartialrelapse}{Among moderate partial recoveries, probability of relapse.}
#'
#'   \item{severerecoverycured}{Among severe recoveries, probability of being cured.}
#'   \item{severerecoveryrelapse}{Among severe recoveries, probability of relapse.}
#'   \item{severepartialcured}{Among severe partial recoveries, probability of being cured.}
#'   \item{severepartialrelapse}{Among severe partial recoveries, probability of relapse.}
#' }
#'
#' @usage data(parameters)
#' @keywords datasets
#'
#' @examples
#' data(parameters)
#' names(parameters)
#' parameters[["excess mortality"]]
"parameters"
# Base case ---------------------------------------------------------------
# Prevention: Sub-clinical depression
data_prev_sub_base <- data.frame(
cov = 0.15,
adh = 0.56,
"1-RR" = 0.21,
N = 30,
"healthcare costs" = 160,
check.names = FALSE
)
# Treatment: Mild depression
data_tr_mild_base <- data.frame(
cov = c(0.02, 0.17),
adh = c(0.43 , 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(265, 962),
check.names = FALSE
)
# Treatment: Moderate depression
data_tr_mod_base <- data.frame(
cov = c(0.02, 0.16),
adh = c(0.43, 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(248, 901),
check.names = FALSE
)
# Treatment: Severe depression
data_tr_sev_base <- data.frame(
cov = c(0.18, 0.20, 0.20),
adh = c(0.68, 0.44, 0.56),
d = c(0.51, 0.3, 0.51),
n = c(30, 30, 30),
"healthcare costs" = c(1984, 607, 679),
check.names = FALSE)
# Prevention: Recurrent depression
data_prev_rec_base <- data.frame(
cov = c(0.15, 0.15, 0.15),
adh = c(0.42, 0.68, 0.56),
'1-RR' = c(0.25, 0.34, 0.32),
n = c(30, 30, 30),
"healthcare costs" = c(1002, 361, 429),
check.names = FALSE
)
# Alt case ----------------------------------------------------------------
# Prevention: Sub-clinical depression
data_prev_sub_alt <- data.frame(
cov = 0.15,
adh = 0.56,
"1-RR" = 0.21,
N = 30,
"healthcare costs" = 160,
check.names = FALSE
)
# Treatment: Mild depression
data_tr_mild_alt <- data.frame(
cov = c(0.02, 0.17),
adh = c(0.43 , 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(265, 962),
check.names = FALSE
)
# Treatment: Moderate depression
data_tr_mod_alt <- data.frame(
cov = c(0.02, 0.16),
adh = c(0.43, 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(248, 901),
check.names = FALSE
)
# Treatment: Severe depression
data_tr_sev_alt <- data.frame(
cov = c(0.18, 0.20, 0.20),
adh = c(0.68, 0.44, 0.56),
d = c(0.51, 0.3, 0.51),
n = c(30, 30, 30),
"healthcare costs" = c(1984, 607, 679),
check.names = FALSE)
# Prevention: Recurrent depression
data_prev_rec_alt <- data.frame(
cov = c(0.15, 0.15, 0.15),
adh = c(0.42, 0.68, 0.56),
'1-RR' = c(0.25, 0.34, 0.32),
n = c(30, 30, 30),
"healthcare costs" = c(1002, 361, 429),
check.names = FALSE
)
usethis::use_data(
data_prev_sub_base,
data_prev_sub_alt,
data_tr_mild_base,
data_tr_mild_alt,
data_tr_mod_base,
data_tr_mod_alt,
data_tr_sev_base,
data_tr_sev_alt,
data_prev_rec_base,
data_prev_rec_alt,
overwrite = TRUE
)
# Parameters --------------------------------------------------------------
parameter_list = list(
`excess mortality` = 1.65,
`retirement rate` = 0.02128,
`death rate` = 0.00198371022638523,
`mean duration of chronicity (year)` = 3.95964163041925,
`increased relapse 1` = 0.5,
`increased relapse 2` = 0.7,
`increased relapse 3` = 0.899999976158142,
`increased relapse 4` = 0.949999988079071,
`increased relapse 5` =  0.990000009536743,
`discount rate daly averted`  = 0.0149999996647239,
`discount rate costs` =  0.03399999991059303,
`dw conversion factor` = 0.172,
`Lower range dw conversion factor` = 0.154,
`Upper range dw conversion factor` =  2*`dw conversion factor` - `Lower range dw conversion factor`,
`Scale/shape Gamma cost distribution` = 6,
`Incidence no history` = 0.0128446472713444,
`pmild` = 0.3,
`pmoderate` =  0.47,
`psevere`  = 0.23,
`mildrecovery` = 0.60,
`mildpartial` = 0.37,
`mildchronic` =  0.03,
`moderaterecovery` =  0.475,
`moderatepartial` =  0.495,
`moderatechronic` = 0.03,
`severerecovery` = 0.51,
`severepartial` = 0.46,
`severechronic` =  0.03,
`mildrecoverycured` = 0.458333,
`mildrecoveryrelapse` = 0.5416666,
`mildpartialcured` = 0.20,
`mildpartialrelapse` =  0.80,
`moderaterecoverycured` = 0.49,
`moderaterecoveryrelapse` = 0.51,
`moderatepartialcured` = 0.25,
`moderatepartialrelapse` = 0.75,
`severerecoverycured` = 0.49,
`severerecoveryrelapse` = 0.51,
`severepartialcured` =  0.25,
`severepartialrelapse` = 0.75)
#' Run base and alternative simulation models
#'
#' @description
#' Wrapper function for running the DepMod model.
#' This function:
#' 1. Builds the transition matrix using `func_first_part_model()`
#' 2. Runs `fun_sim_model()` for both BASE and ALTERNATIVE scenarios.
#'
#' This function requires:
#'
#' **(A) Data frames for the BASE scenario**
#'
#' \describe{
#'   \item{df_prev_sub_base}{Parameters for preventive interventions in sub-clinical depression.}
#'   \item{df_tr_mild_base}{Treatment parameters for mild cases.}
#'   \item{df_tr_mod_base}{Treatment parameters for moderate cases.}
#'   \item{df_tr_sev_base}{Treatment parameters for severe cases.}
#'   \item{df_prev_rec_base}{Parameters for preventive interventions targeting recurrent depression.}
#' }
#'
#'
#' **(B) Data frames for the ALTERNATIVE scenario**
#'
#' \describe{
#'   \item{df_prev_sub_alt}{Alternative preventive intervention parameters (sub-clinical).}
#'   \item{df_tr_mild_alt}{Alternative treatment parameters (mild).}
#'   \item{df_tr_mod_alt}{Alternative treatment parameters (moderate).}
#'   \item{df_tr_sev_alt}{Alternative treatment parameters (severe).}
#'   \item{df_prev_rec_alt}{Alternative preventive parameters for recurrent depression.}
#' }
#'
#'
#' **(C) Simulation-wide numeric parameters (`parameters` list)**
#'
#' The list must contain the following numeric values:
#'
#' **General simulation parameters**
#' \describe{
#'   \item{dw_conversion_fact}{Disability-weight conversion factor.}
#'   \item{discount_rate_daly}{Discount rate for DALYs.}
#'   \item{scale_shape_gamma_cost}{Gamma distribution scale/shape cost factor.}
#'   \item{disc_rate_cost}{Discount rate for economic costs.}
#'   \item{leavemodel}{Probability of leaving the model.}
#'   \item{mean_dur_chron}{Mean duration of chronic phase.}
#' }
#'
#' **Population incidence inputs**
#' \describe{
#'   \item{incidence_no_history}{Incidence among individuals without prior disease.}
#'   \item{pmild}{Proportion of incident mild cases.}
#'   \item{pmoderate}{Proportion of incident moderate cases.}
#'   \item{psevere}{Proportion of incident severe cases.}
#' }
#'
#' **Stage-progression probabilities**
#' \describe{
#'   \item{mildrecovery}{Recovery probability from mild depression.}
#'   \item{mildpartial}{Partial remission probability (mild).}
#'   \item{mildchronic}{Chronic transition probability (mild).}
#'
#'   \item{moderaterecovery}{Recovery probability (moderate).}
#'   \item{moderatepartial}{Partial remission probability (moderate).}
#'   \item{moderatechronic}{Chronic transition probability (moderate).}
#'
#'   \item{severerecovery}{Recovery probability (severe).}
#'   \item{severepartial}{Partial remission probability (severe).}
#'   \item{severechronic}{Chronic transition probability (severe).}
#' }
#'
#' **Recovery-state outcomes**
#' \describe{
#'   \item{mildrecoverycured}{Cure probability from mild–recovery.}
#'   \item{mildrecoveryrelapse}{Relapse probability from mild–recovery.}
#'   \item{mildpartialcured}{Cure probability from mild–partial.}
#'   \item{mildpartialrelapse}{Relapse probability from mild–partial.}
#'
#'   \item{moderaterecoverycured}{Cure probability from moderate–recovery.}
#'   \item{moderaterecoveryrelapse}{Relapse probability from moderate–recovery.}
#'   \item{moderatepartialcured}{Cure probability from moderate–partial.}
#'   \item{moderatepartialrelapse}{Relapse probability from moderate–partial.}
#'
#'   \item{severerecoverycured}{Cure probability from severe–recovery.}
#'   \item{severerecoveryrelapse}{Relapse probability from severe–recovery.}
#'   \item{severepartialcured}{Cure probability from severe–partial.}
#'   \item{severepartialrelapse}{Relapse probability from severe–partial.}
#' }
#'
#' **Relapse multipliers**
#' \describe{
#'   \item{increased_relapse_1}{Relapse multiplier (category 1).}
#'   \item{increased_relapse_2}{Relapse multiplier (category 2).}
#'   \item{increased_relapse_3}{Relapse multiplier (category 3).}
#'   \item{increased_relapse_4}{Relapse multiplier (category 4).}
#'   \item{increased_relapse_5}{Relapse multiplier (category 5).}
#' }
#'
#'
#' **(E) Additional general arguments**
#' \describe{
#'   \item{sim_runs}{Number of simulation runs. Set at default at 1000}
#'   \item{total_population}{Number of individuals simulated. Set at default at 10518000}
#' }
#'
#' @return
#' A list with two elements:
#' \describe{
#'   \item{base}{Output using the base scenario.}
#'   \item{alt}{Output using the alternative scenario}
#' }
#'
#' @export
run_model <- function(
parameters = parameter_list,
sim_runs = 1000,
total_population = 10518000,
# Base data frames
df_prev_sub_base = data_prev_sub_base,
df_tr_mild_base = data_tr_mild_base,
df_tr_mod_base = data_tr_mod_base,
df_tr_sev_base = data_tr_sev_base,
df_prev_rec_base = data_prev_rec_base,
# Alternative data frames
df_prev_sub_alt = data_prev_sub_alt,
df_tr_mild_alt = data_tr_mild_alt,
df_tr_mod_alt = data_tr_mod_alt,
df_tr_sev_alt = data_tr_sev_alt,
df_prev_rec_alt = data_prev_rec_alt
# Numeric parameters
) {
# --- 0. Rename names in list for model runs ----------------------------------
rename_map <- c(
"excess mortality" = "excess_mortality",
"retirement rate" = "retirement_rate",
"death rate" = "death_rate",
"mean duration of chronicity (year)" = "mean_dur_chron",
"increased relapse 1" = "increased_relapse_1",
shiny::runApp('inst/app')
runApp('inst/app')
runApp('inst/app')
#' Run the Shiny app
#'
#' Launches the Shiny app included in this package.
#' @export
run_app <- function(...) {
app_dir <- system.file("app", package = utils::packageName())
if (!nzchar(app_dir)) {
stop("App directory not found. Was the package installed correctly?",
call. = FALSE)
}
shiny::shinyAppDir(appDir = app_dir, ...)
}
shiny::runApp('inst/app')
runApp('inst/app')
runApp('inst/app')
runApp('inst/app')
devtools::check(args = "--as-cran")
rm(list = "run_app")
devtools::load_all()
devtools::check(args = "--as-cran")
devtools::load_all()
devtools::check(args = "--as-cran")
devtools::load_all()
devtools::check(args = "--as-cran")
pkgbuild::check_build_tools(debug = TRUE)
devtools::check_win_devel()
devtools::check_win_devel()
options(
winbuilder_email = "s.b.peeters@eshpm.eur.nl"
)
devtools::check_win_devel()
devtools::check_win_devel()
devtools::check_win_devel()
devtools::check_win_devel()
devtools::check_win_devel()
devtools::check_win_devel()
unlink(c(".RDataTmp", ".RDataTmp1", ".RDataTmp2", ".RDataTmp3", ".RDataTmp4", ".RDataTmp5"),
recursive = TRUE, force = TRUE)
list.files(all.files = TRUE)
unlink(".RDataTmp6")
list.files(all.files = TRUE)
usethis::use_mit_license(DepMod)
usethis::use_mit_license("DepMod")
run_app()
shiny::runApp('inst/app')
devtools::check(args = "--as-cran")
devtools::check_win_devel()
devtools::document()
rm(list = c("run_app", "run_model"))
devtools::document()
devtools::check_win_devel()
list.files()
unlink(list.files(pattern = "^DepMod_.*\\.tar\\.gz$"))
unlink(c(".RDataTmp", ".RDataTmp1", ".RDataTmp2", ".RDataTmp3", ".RDataTmp4", ".RDataTmp5"),
recursive = TRUE, force = TRUE)
unlink("inst/app/Depmod/.Rbuildignore", force = TRUE)
devtools::document()
usethis::use_news_md()
devtools::build_readme()
usethis::use_news_md()
devtools::build_readme()
devtools::build_readme()
usethis::use_version('minor')
devtools::document()
devtools::submit_cran()
usethis::use_cran_comments()
devtools::submit_cran()
devtools::document()
# Base case ---------------------------------------------------------------
# Prevention: Sub-clinical depression
data_prev_sub_base <- data.frame(
cov = 0.15,
adh = 0.56,
"1-RR" = 0.21,
n = 30,
"healthcare costs" = 160,
check.names = FALSE
)
# Treatment: Mild depression
data_tr_mild_base <- data.frame(
cov = c(0.02, 0.17),
adh = c(0.43 , 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(265, 962),
check.names = FALSE
)
# Treatment: Moderate depression
data_tr_mod_base <- data.frame(
cov = c(0.02, 0.16),
adh = c(0.43, 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(248, 901),
check.names = FALSE
)
# Treatment: Severe depression
data_tr_sev_base <- data.frame(
cov = c(0.18, 0.20, 0.20),
adh = c(0.68, 0.44, 0.56),
d = c(0.51, 0.3, 0.51),
n = c(30, 30, 30),
"healthcare costs" = c(1984, 607, 679),
check.names = FALSE)
# Prevention: Recurrent depression
data_prev_rec_base <- data.frame(
cov = c(0.15, 0.15, 0.15),
adh = c(0.42, 0.68, 0.56),
'1-RR' = c(0.25, 0.34, 0.32),
n = c(30, 30, 30),
"healthcare costs" = c(1002, 361, 429),
check.names = FALSE
)
# Alt case ----------------------------------------------------------------
# Prevention: Sub-clinical depression
data_prev_sub_alt <- data.frame(
cov = 0.15,
adh = 0.56,
"1-RR" = 0.21,
n = 30,
"healthcare costs" = 160,
check.names = FALSE
)
# Treatment: Mild depression
data_tr_mild_alt <- data.frame(
cov = c(0.02, 0.17),
adh = c(0.43 , 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(265, 962),
check.names = FALSE
)
# Treatment: Moderate depression
data_tr_mod_alt <- data.frame(
cov = c(0.02, 0.16),
adh = c(0.43, 0.56),
d = c(0.33, 0.51),
n = c(30, 30),
"healthcare costs" = c(248, 901),
check.names = FALSE
)
# Treatment: Severe depression
data_tr_sev_alt <- data.frame(
cov = c(0.18, 0.20, 0.20),
adh = c(0.68, 0.44, 0.56),
d = c(0.51, 0.3, 0.51),
n = c(30, 30, 30),
"healthcare costs" = c(1984, 607, 679),
check.names = FALSE)
# Prevention: Recurrent depression
data_prev_rec_alt <- data.frame(
cov = c(0.15, 0.15, 0.15),
adh = c(0.42, 0.68, 0.56),
'1-RR' = c(0.25, 0.34, 0.32),
n = c(30, 30, 30),
"healthcare costs" = c(1002, 361, 429),
check.names = FALSE
)
usethis::use_data(
data_prev_sub_base,
data_prev_sub_alt,
data_tr_mild_base,
data_tr_mild_alt,
data_tr_mod_base,
data_tr_mod_alt,
data_tr_sev_base,
data_tr_sev_alt,
data_prev_rec_base,
data_prev_rec_alt,
overwrite = TRUE
)
devtools::document()
devtools::submit_cran()
